frc.prototype.xC=W(1322,function(a){if(!this.isDisposed()&&this.Cb()){this.D=a;a=this.Ea("waffle-dbsource-pill-menuitem-refreshquery-info-message");var b=this.Ea("waffle-dbsource-pill-menuitem-refreshquery-info-error-button");Q(a,!1);Q(b,!0)}});BQ.prototype.xC=W(1321,function(a){this.C["refresh-query"].xC(a)});mrc.prototype.xC=W(1320,function(a){this.F.xC(a)});R_.prototype.xC=W(1319,function(a){if(this.Cb()){var b=this.H;b.F=a;r2e(b);Q(b.Ea("waffle-dbobject-estimated-bytes-error"),!0);b.C.setActive(!1)}});
function wtg(a,b){E(a,1,b)}function xtg(){var a=wM.getInstance();return new ro(function(b,c){eEe(a,"/dbx/schedules",function(d){var e=new lk;e.Ig=!0;d=e.Qc(I6b.Aa(),d.Fe());b(d)},c)})}function ytg(a){var b=wM.getInstance(),c=new lk;c.Ig=!0;var d=c.serialize(a);return new ro(function(e,f){xM(b,"/dbx/createSchedule",[],d,function(h){c.Ig=!0;h=c.Qc(C6b.Aa(),h.Fe());e(h)},f)})}
function ztg(a){var b=wM.getInstance(),c=new lk;c.Ig=!0;var d=c.serialize(a);return new ro(function(e,f){xM(b,"/dbx/updateSchedule",[],d,function(h){c.Ig=!0;h=c.Qc(G6b.Aa(),h.Fe());e(h)},f)})}function Atg(a){if(!ritz_api.BigSheetsApi.isExternalDataForDbObject(a)||ritz_api.BigSheetsApi.isExternalDataForDatasourceSheetPreview(a))return!1;a=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(a);return W8b.has(a)}
function Btg(a){var b=[];a=ja(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,Atg(c)&&b.push(c);return b}function Ctg(a){if(zM(a.L))return[];var b=[];a.C.forEach(function(c,d){K8b.has(c.D)&&Atg(d)&&b.push(d)});return b}function Dtg(a,b){b=b.map(function(c){return new X6b(c.hx(),c.Dh())});M8b(a,b,!1)}
function Etg(a,b,c,d){UDd(a.F,b,function(e){var f=e.filter(function(h){return 2==h.Dh().getState()});e=e.filter(function(h){return 2!=h.Dh().getState()});Dtg(a,e);c(f)},function(e){Dtg(a,e);d(e)})}function Ftg(a){a.Cb()&&r2e(a.H)}
function Gtg(){return T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="#188038" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>')}
function Htg(a,b){R_.call(this,a,b)}u(Htg,R_);Htg.prototype.R=function(){this.refresh()};Htg.prototype.refresh=function(){if(this.Cb()){var a=BC.isEnabled();a=this.J&&this.L&&a&&0<Ctg(this.F).length;this.C.Na(a)}};Htg.prototype.O=m("Refresh all");function Itg(a,b,c){b=c||b;a=a||{};a=""+S(BZ(Xv({title:"Refresh data",Qu:"waffle-dataconnector-refresh-sidepane",wC:$v(""+S(Gtg())),Zj:$v('<div class="'+U("waffle-dataconnector-refresh-sidepane-container")+'"><div class="'+U("waffle-dataconnector-refresh-sidepane-refresh-widget")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-sidepane-backdrop")+'"></div>'),fR:!0,pR:$v('<div class="'+U("waffle-dataconnector-refresh-sidepane-footer-wrapper")+'"></div>')},a),b));return T(a)}
function Jtg(){var a='<div class="'+U("waffle-dataconnector-refresh-sidepane-stale-widget")+'" role="dialog">'+S(Gtg())+'<div class="'+U("waffle-dataconnector-refresh-sidepane-stale-widget-title")+'">';a=a+'This panel is out of sync</div><div class="'+(U("waffle-dataconnector-refresh-sidepane-stale-widget-info")+'">');a=a+'Reload to continue</div><div class="'+(U("waffle-dataconnector-refresh-sidepane-stale-widget-button-wrapper")+'"></div></div>');return T(a)};function Ktg(){return T('<div class="'+U("waffle-dataconnector-refresh-all-pane")+'"><div class="'+U("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function Ltg(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function Mtg(a,b,c){b=c||b;return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+Ltg(null,b))}function Ntg(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function Otg(a){a=a.title;a='<div class="'+U("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+S(Yqc(null))+'</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+S(a)+'</div><div class="'+
U("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return T(a+"Running\u2026</div></div></div>")};function Ptg(a,b,c,d){R.call(this,d);this.D=a;this.H=b;this.L=c;this.J=new Sqc;this.C=new VY(!1);this.F=!0}u(Ptg,R);p=Ptg.prototype;p.Ba=function(){this.ib(qx(Otg,{title:this.H}));zw(this.Ea("waffle-dataconnector-refresh-all-dbobject-item-title"),this.H)};
p.Ia=function(){R.prototype.Ia.call(this);Dw(this.Ka(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));var a=this.C;a.C="#0f9d58";a.Cb()&&xNe(a);this.getHandler().listen(this.Ka(),"click",this.AOa).listen(this.Ka(),"keydown",this.oRb);Qtg(this)};
function Qtg(a){var b=EV(a.L,a.D);switch(b.getType()){case "invalid-db-object":case "insufficient-access":case "fetch-failed":Rtg(a,"waffle-dataconnector-refresh-all-dbobject-item-error");Stg(a);break;case "offline":Stg(a);break;case "loading":Rtg(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");Ttg(a);break;case "fetching-results":Rtg(a,"waffle-dataconnector-refresh-all-dbobject-item-running");Ttg(a);break;case "no-results":Utg(a);Stg(a);break;case "fetch-successful":b=b.C.Ut();b=a.J.format(b);
ao(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);zw(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);Rtg(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");Stg(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}
p.Na=function(a){this.F=a;var b=this.Ka();a?Jw(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):Jw(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};function Rtg(a,b){Utg(a);Q(a.Ea(b),!0)}
function Stg(a){a.C.setActive(!1);Q(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);Q(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function Ttg(a){a.C.setActive(!0);Q(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);Q(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}p.oRb=function(a){13===a.keyCode&&this.AOa()};p.AOa=function(){if(this.F){var a=new FH("refresh-db-object-request");a.GBa=this.D;this.dispatchEvent(a)}};
function Utg(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return Q(a.Ea(b),!1)})};function Vtg(a,b,c,d,e){R.call(this,e);this.L=new Set(a);this.J=b;this.H=[];this.F=c;this.D=this.C=null;d&&(this.C=new Wtg(this.qa()),this.D=new L1e(this.F,this.qa(),!0,!0));this.O=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}u(Vtg,R);Vtg.prototype.Ba=function(){if(this.D){var a=Jn("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.ib(a);this.Ga(this.D,!0);this.D.setContent(qx(Ltg));Dw(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.ib(qx(Mtg))};
Vtg.prototype.Ia=function(){var a=this;R.prototype.Ia.call(this);this.D||ao(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.F);Xtg(this);var b=this.getHandler();this.H.forEach(function(c){b.listen(c,"refresh-db-object-request",function(d){d=d.GBa;K8b.has(EV(a.J,d).D)&&Oob.Bb([d])})});this.C&&(this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),b.listen(this.C,"action",this.R))};
function Xtg(a){var b=a.Ea("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.L.forEach(function(c){var d=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(c);d=Ytg(a,d);c=new Ptg(c,d,a.J,a.qa());a.H.push(c);c.render(b)})}function Ytg(a,b){switch(b){case 1:return"Pivot table "+Ztg(a,1);case 2:return"Chart "+Ztg(a,2);case 3:return"Function "+Ztg(a,3);case 4:return"Preview";case 5:return"Extract "+Ztg(a,5);default:throw Error("Unexpected DbObjectType");}}
function Ztg(a,b){var c=a.O.get(b);a.O.set(b,c+1);return 0==c?"":c.toString()}Vtg.prototype.R=function(){var a=this,b=Array.from(this.L).filter(function(c){return K8b.has(EV(a.J,c).D)});Oob.Bb(b)};function $tg(a){a.H.forEach(function(b){return Qtg(b)})}function aug(a,b){a.C&&(b=b.filter(function(c){return a.L.has(c.hx())}),bug(a.C,b))}function cug(a,b){a.F=b;a.D?a.D.getHeader().setContent(b):ao(a.Ea("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}
Vtg.prototype.Na=function(a){this.C&&this.C.Na(a);this.H.forEach(function(b){return b.Na(a)})};function Wtg(a){R.call(this,a);this.D=new gV("Refresh",this.qa());this.Ga(this.D);this.C=new q2e;this.Ga(this.C)}u(Wtg,R);Wtg.prototype.Ba=function(){this.ib(qx(Ntg))};Wtg.prototype.Ia=function(){R.prototype.Ia.call(this);this.D.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};
function bug(a,b){var c=0;b.forEach(function(d){return c+=parseInt(D(d,2),10)});t2e(a.C,c);a.D.Na(!0)}Wtg.prototype.Na=function(a){this.D.Na(a)};function dug(a,b){R.call(this,b);this.H=a;this.F=a.O;this.D=new R;this.Ga(this.D);this.C=[]}u(dug,R);dug.prototype.Ba=function(){this.ib(qx(Ktg))};dug.prototype.Ia=function(){var a=this;R.prototype.Ia.call(this);this.D.Wa(this.Ea("waffle-dataconnector-refresh-all-datasources-container"));eug(this);this.getHandler().listen(this.H.C,"na",function(b){return fug(a,b)})};
function eug(a){a.C=[];var b=gug(a);if(1==b.size){var c=b.entries().next().value;b=c[1];c=hug(a,c[0]);b=new Vtg(b,a.F,c,!1,a.qa());a.C.push(b);a.D.Ga(b,!0)}else{c=ja(b.keys());for(var d=c.next();!d.done;d=c.next()){var e=d.value;d=hug(a,e);e=b.get(e);d=new Vtg(e,a.F,d,!0,a.qa());a.C.push(d);a.D.Ga(d,!0)}}1<a.C.length&&a.C[0].D.getHeader().Zb(!0)}
function gug(a){var b=new Map;Btg(a.F).forEach(function(c){var d=ritz_api.BigSheetsApi.getDataSourceIdForExternalDataId(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function hug(a,b){b=ritz_api.BigSheetsApi.getSheetIdForDatasourceId(b);return pJ(a.H.C,b).Sd()}function iug(a,b){a.C.forEach(function(c){return aug(c,b)})}function jug(a){a.C.forEach(function(b){b.C&&s2e(b.C.C)})}function kug(a){a.C.forEach(function(b){b.C&&(b=b.C,r2e(b.C),b.D.Na(!1))})}
function lug(a){a.C.forEach(function(b){return $tg(b)})}dug.prototype.Na=function(a){this.C.forEach(function(b){return b.Na(a)})};function fug(a,b){3==pJ(a.H.C,b.Wg).getSheetType()&&(a=a.C.find(function(c){return c.F==b.C}))&&cug(a,b.Bl)};function mug(a,b,c){b=void 0===b?hW.getInstance():b;Fx.call(this,"",void 0,c);a&&nug(a);this.C=new oug(a,b,c);this.Ga(this.C)}u(mug,Fx);p=mug.prototype;p.Ba=function(){this.C.Ba();this.ib(this.C.Ka())};p.Nc=function(a){a.Bm(!0);this.C.Nc(a)};p.Dt=function(a,b){a.Bm(!0);this.C.Dt(a,b)};p.zf=function(a){return this.C.zf(a)};p.dh=function(){return this.C.dh()};p.Fd=function(){return this.C.C.map(function(a){return a.getValue()})};
function pug(a,b){a=a.C;for(var c=ja(a.C),d=c.next();!d.done;d=c.next())d.value.Zb(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.dh();e++){var f=a.zf(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Zb(!0),c.push(f),0==--d))break}a.C=c}a.yC()}p.Nb=function(){return this.C.Nb()};p.Be=function(a){nug(a);this.C.Be(a)};p.Bd=function(a){this.C.Bd(a)};function nug(a){for(var b=0;b<a.Kc();b++)a.Gc(b).Bm(!0)}function oug(a,b,c){b=void 0===b?hW.getInstance():b;KZ.call(this,a,b,c);this.C=[]}
u(oug,KZ);oug.prototype.Be=function(a){KZ.prototype.Be.call(this,a);this.C=[];this.yC()};oug.prototype.Rr=function(a){a.stopPropagation();a=a.target;if(a.isChecked()){var b=this.Nb();KBe(this.C,a,function(c,d){return bd(Qv(b,c),Qv(b,d))})}else Uc(this.C,a);this.yC();this.dispatchEvent("change")};oug.prototype.J=function(){var a;0==this.C.length?a=this.F:a=this.C.map(function(b){return b.yg()}).join(", ");return a||""};function qug(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(U("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
U("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+U("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-date-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-time-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
U("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return T(a)};var rug=new BB(7),sug=new BB(DB.MONTH_DAY_ABBR),tug=new cA("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function uug(a,b,c){R.call(this,c);this.Oa=a;a=new xy;a.Ga(new sy("Every day",1),!0);a.Ga(new sy("Every week",2),!0);a.Ga(new sy("Every month",3),!0);this.H=new KZ(a,hW.getInstance(),c);Sy(this.H,"Add frequency");this.H.Bd("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Ga(this.H);this.D=new mug(void 0,hW.getInstance(),c);Sy(this.D.C,"Add date");this.D.Bd("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");this.Ga(this.D);a=new xy;for(var d=
new Date(Da()),e=Array(24),f=0;24>f;f++){d.setHours(f,0,0,0);var h=new Date(d.getTime()),k=new Date(d.getTime());k.setHours(h.getHours()+4);k=vug(h,k);e[h.getHours()]={value:f,label:k}}for(d=0;24>d;d++)f=new sy(e[d].label,e[d].value),a.Ga(f,!0);this.J=new KZ(a,hW.getInstance(),c);Sy(this.J,"Add time");this.J.Bd("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Ga(this.J);this.O=new gV("Cancel");this.Ga(this.O);this.R=new dB("Save",c);this.R.Na(!1);this.Ga(this.R);this.V=
new oy("",yO.getInstance(),c);this.Ga(this.V);this.Ca=new oy("Setup now",yO.getInstance(),c);this.Ga(this.Ca);this.xa=new oy("",yO.getInstance(),c);this.Ga(this.xa);this.F=new eW(c);this.F.He("Enable schedule");this.Ga(this.F);this.cb=3;this.C=null;this.Ha=new q3e(500,500,"dbxScheduleOnCompleteAuth");this.va(this.Ha);this.ma=b;this.La=new ez(this);this.va(this.La);this.L=new W3e(c);this.L.Hc("waffle-dataconnector-refresh-schedules-info-icon");this.L.setVisible(!1);this.Pa=new VY(!0);this.Fa=!1;wug(this)}
u(uug,R);function wug(a){a.La.Tb(epb,$r,function(b){return void xug(a,b.data,null)}).Tb(fpb,$r,function(b){return void yug(a,b.data,null)}).Tb(gpb,$r,function(){var b=D(a.C,2);b.Na(!0);yug(a,b,null)}).Tb(hpb,$r,function(){var b=D(a.C,2);b.Na(!1);yug(a,b,null)})}p=uug.prototype;
p.Ba=function(){R.prototype.Ba.call(this);this.ib(qx(qug));var a=this.L.C;a.setContent(me("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.L.render(this.Ea("waffle-dataconnector-refresh-schedules-header-title"));a=a.Jb();ww(this.L.Ka(),"labelledby",a.id)};
p.Ia=function(){R.prototype.Ia.call(this);this.O.render(this.Ea("waffle-dataconnector-refresh-schedules-cancel-btn"));this.V.render(this.Ea("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Ea("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Ea("waffle-dataconnector-refresh-schedules-frequency-select"));this.R.render(this.Ea("waffle-dataconnector-refresh-schedules-save-btn"));this.Ca.render(this.Ea("waffle-dataconnector-refresh-schedules-setup-btn"));
this.xa.render(this.Ea("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));this.J.render(this.Ea("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Ea("waffle-dataconnector-refresh-schedules-date-select"));this.Pa.render(this.Ea("waffle-dataconnector-refresh-schedules-spinner"));zug(this,!1);Fy(this.J,new tw(null,13));this.getHandler().listen(this.V,"action",this.eTb).listen(this.O,"action",this.ISb).listen(this.R,"action",this.uUb).listen(this.Ca,"action",this.yUb).listen(this.F,
"action",this.fTb).listen(this.H,"change",this.qTb).listen(this.D,"change",this.M2).listen(this.J,"change",this.M2).listen(this.xa,"action",this.QUb);0<Array.from(this.Oa.C.keys()).length?(Q(this.Ka(),!0),Aug(this)):Q(this.Ka(),!1)};
function Bug(a){if(!a.isDisposed()){var b=a.Ea("waffle-dataconnector-refresh-schedules-edit-section"),c=a.Ea("waffle-dataconnector-refresh-schedules-overview-section"),d=a.Ea("waffle-dataconnector-refresh-schedules-fullview-section"),e=a.Ea("waffle-dataconnector-refresh-schedules-owner-info"),f=a.Ea("waffle-dataconnector-refresh-schedules-setup-btn"),h=a.Ea("waffle-dataconnector-refresh-schedules-enable-switch"),k=a.Ea("waffle-dataconnector-refresh-schedules-spinner");Q(f,!1);Q(h,!1);Q(b,!1);Q(c,
!1);Q(d,!1);Q(e,!1);Q(k,!1);Hw(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var l=!1;a.L.setVisible(!1);switch(a.cb){case 1:Q(f,!0);break;case 2:Q(d,!0);Q(b,!0);Q(e,!0);Hw(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);l=!0;Cug(a);Dug(a);a.M2();a.O.Na(!0);a.L.setVisible(!0);break;case 3:Q(k,!0);break;case 5:Q(d,!0);Q(h,!0);Q(b,!0);Q(e,!0);Hw(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);l=!0;Eug(a);Cug(a);Dug(a);b=D(a.C,2);a.F.Zb(!!D(b,1));
c=b.$n().$n();a.H.setValue(c);switch(c){case 1:zug(a,!1);break;case 2:pug(a.D,Rf(b.$n(),4));zug(a,!0);break;case 3:pug(a.D,Rf(b.$n(),5)),zug(a,!0)}a.J.setValue(D(b.$n(),2));a.M2();a.O.Na(!0);a.L.setVisible(!0);break;case 4:Q(h,!0),Q(c,!0),Eug(a),c=a.Ea("waffle-dataconnector-refresh-schedules-overview-text"),Fug(a)?(b=a.C.getStatus(),ao(c,"Next: "),c=new Date(1E3*D(b,2)),b=new Date(1E3*D(b,3)),a.V.setContent(no(a.qa(),Gug(c,b,a.ma,!0)))):(ao(c,"Paused"),a.V.setContent("Edit"))}a.Fa!=l&&(a.Fa=l,a.dispatchEvent(l?
"ii":"hi"))}}function Eug(a){var b=!!D(D(a.C,2),1);a.F.Zb(b);a.F.Na(!0)}function Cug(a){var b=a.Ea("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=D(D(a.C,4),1))&&(c+=" Currently running as "+a);ao(b,c)}
function Dug(a){var b=a.Ea("waffle-dataconnector-refresh-schedules-fullview-text");if(Fug(a)){var c=a.C.getStatus(),d=new Date(1E3*D(c,2));c=new Date(1E3*D(c,3));var e=a.qa();e.bd(b);e.appendChild(b,no(e,re(me("Next: "),Gug(d,c,a.ma,!1))))}else ao(b,"");a.xa.setContent(Hug(a.ma))}function Fug(a){return a.C&&D(D(a.C,2),1)?(D(a.C.getStatus(),1),!0):!1}p.ISb=function(){this.cb=2==this.cb?1:4;Bug(this);this.Ea("waffle-dataconnector-refresh-schedules-title").focus()};p.eTb=function(){this.cb=5;Bug(this)};
p.qTb=function(){var a=this.H.getValue();pug(this.D,[]);switch(a){case 1:zug(this,!1);break;case 2:zug(this,!0);a=this.D.Be(Iug());rf(a);break;case 3:zug(this,!0),a=this.D.Be(Jug()),rf(a)}this.M2()};
p.uUb=function(){this.R.Na(!1);this.O.Na(!1);var a=this.H.getValue(),b=new PL,c=new RL;c.mC(a);if(2===a){var d=ja(this.D.Fd());for(a=d.next();!a.done;a=d.next())Pf(c,4,a.value)}else if(3===a)for(d=ja(this.D.Fd()),a=d.next();!a.done;a=d.next())Pf(c,5,a.value);a=this.J.getValue();E(c,2,a);b.mC(c);E(b,3,1);2==this.cb?(b.Na(!0),epb.Bb(b)):(b.Na(this.F.isChecked()),fpb.Bb(b))};p.yUb=function(){this.cb=2;Bug(this)};
p.fTb=function(){if(4==this.cb){var a=this.F.isChecked();this.F.Zb(!a);this.F.Na(!1);if(a){var b=Kug(this);b.render();b.setVisible(!0);b.getResult().then(function(){rf(b);gpb.Bb()},function(){rf(b)})}else hpb.Bb()}};p.QUb=function(){zE.Bb()};p.M2=function(){var a=!!this.H.We(),b=1===this.H.getValue()||0<this.D.Fd().length,c=!!this.J.We();this.R.Na(a&&b&&c)};
function xug(a,b,c,d){d=void 0===d?!0:d;var e=new A6b;E(e,1,b);c&&E(e,2,c);ytg(e).then(function(f){return Lug(a,b,f.getStatus(),D(f,2),!0,d)},function(){Mug(a)})}function yug(a,b,c,d){d=void 0===d?!0:d;var e=new E6b;wtg(e,a.C.getId());E(e,2,b);c&&E(e,3,c);ztg(e).then(function(f){return Lug(a,b,f.getStatus(),D(f,2),!1,d)},function(){Mug(a)})}
function Lug(a,b,c,d,e,f){a.F.Na(!0);switch(c){case 1:a.Ea("waffle-dataconnector-refresh-schedules-title").focus();Aug(a);break;case 2:if(!f)break;r3e(a.Ha,d,function(h){a.isDisposed()||(a.F.Na(!1),e?xug(a,b,h,!1):yug(a,b,h,!1))});break;default:Mug(a)}}function Aug(a){a.cb=3;Bug(a);xtg().then(function(b){a.isDisposed()||(b=Rf(b,1),0==b.length?(a.cb=1,a.C=null):(a.cb=4,a.C=b[0]),Bug(a))},function(){yz.getInstance().postMessage(Az("Error loading schedule configuration.","error",!0))})}
function zug(a,b){Q(a.Ea("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function Kug(a){var b=new q4e;b.Hc("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.H.setContent("Cancel");var c=D(a.C,2);switch(c.$n().$n()){case 1:var d="Daily ";break;case 2:d=Nug();var e=Rf(c.$n(),4);d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(Rf(c.$n(),5).map(function(l){return tug.format({DAY:l})}).join(", ")+" ")}var f=
a.C.getStatus();c=Oug(a.ma);var h=new Date(Da()),k=new Date(1E3*D(f,2));f=new Date(1E3*D(f,3));d+=vug(k,f,c)+" ("+djb(c.C-AB(c,h))+")";a="Will run as "+D(D(a.C,4),1);a=re(me("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),oe("H4",void 0,"Schedule"),me(d),oe("BR"),me(a));Sw(b,a);return b}function Mug(a){yz.getInstance().postMessage(Az("Error saving schedule.","error",!0));a.R.Na(!0);a.O.Na(!0);a.F.Na(!0)}
function Nug(){var a=(vB.FIRSTDAYOFWEEK+1)%7,b=vB.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}function Iug(){var a=new xy,b=Nug();b=ja(b);for(var c=b.next();!c.done;c=b.next())c=c.value,a.Ga(new sy(c.label,c.value),!0);return a}function Jug(){for(var a=new xy,b=1;28>=b;b++)a.Ga(new sy(tug.format({DAY:b}),b),!0);return a}function vug(a,b,c){return rug.format(a,c)+" - "+rug.format(b,c)}
function Gug(a,b,c,d){var e=new HB,f=Oug(c);f=sug.format(a,f)+" \u00b7 "+vug(a,b,f);a.getDate()!==b.getDate()&&(f+=e.fd("sup")+"+1"+e.cd("sup"));d&&(f+=" ("+Hug(c)+")");return e.format(f)}function Hug(a){var b=new Date(Da());a=Oug(a);return djb(a.C-AB(a,b))}function Oug(a){var b=new Date(Da());a=-1*a.getTimezoneOffset(b);return zB(a/6E4)};function Pug(a,b,c){eZ.call(this,c);this.R=b;this.L=b.O;this.O=a;this.Qx=new dug(b,this.qa());this.Ga(this.Qx);this.D=new Htg(this.L,c);this.va(this.D);this.F=null;this.H=new Qug(this.qa());this.Ga(this.H);this.J=null}u(Pug,eZ);p=Pug.prototype;p.Ba=function(){eZ.prototype.Ba.call(this);this.ib(qx(Itg,{id:this.getId(),Ud:!0}));this.D.render(this.Ea("waffle-dataconnector-refresh-sidepane-footer-wrapper"))};
p.Ia=function(){var a=this;eZ.prototype.Ia.call(this);A(z(),"fedsr")&&(Rug(this),this.getHandler().listen(this,["hi","ii"],this.Vub));this.H.render(this.Ka());Q(this.H.Ka(),!1);this.getHandler().listen(this.H,"action",this.Ltb);this.Qx.render(this.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget"));this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=Ctg(a.L);Oob.Bb(b)});this.D.refresh();Q(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)};
function Sug(a){rf(a.Qx);a.Qx=new dug(a.R,a.qa());a.Ga(a.Qx);a.Qx.render(a.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget"));a.D.refresh()}function Tug(a){null!=a.F&&(rf(a.F),rf(a.J),Rug(a))}function Uug(a){Q(a.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!0);Q(a.H.Ka(),!0);setTimeout(function(){if(a.H.Cb()){var b=a.H.Ka();a.J=new SA(b,a.qa());a.va(a.J);TA(a.J);b.focus()}},500)}function Vug(a){Q(a.H.Ka(),!1);Q(a.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)}
function Wug(a,b){iug(a.Qx,b);var c=0;b.forEach(function(d){return c+=parseInt(D(d,2),10)});a.D.Xu(c)}p.Vub=function(a){var b=this;a="ii"===a.type;Q(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),a);mv(this.Ea("waffle-sidebar-content"),"overflow-y",a?"hidden":"auto");rf(this.J);a?setTimeout(function(){if(b.F.Cb()){var c=b.F.Ka();b.J=new SA(c,b.qa());b.va(b.J);TA(b.J);c.focus()}},500):this.resize()};
function Rug(a){a.F=new uug(a.L,a.O,a.qa());a.Ga(a.F);a.F.render(a.Ka());Q(a.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)}p.Ltb=function(){Q(this.H.Ka(),!1);Q(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1);var a=this.Qx,b=a.D.bd(!0);sf(b);eug(a);this.Ka().focus()};p.resize=function(){if(this.F&&!this.F.Fa){var a=Av(this.Ea("waffle-sidebar-content")).height-Av(this.F.Ka()).height,b=this.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget");zv(b,a)}};
function Qug(a){R.call(this,a);this.C=new dB("OK",this.qa());this.Ga(this.C)}u(Qug,R);
Qug.prototype.Ba=function(){R.prototype.Ba.call(this);this.ib(qx(Jtg));this.C.render(this.Ea("waffle-dataconnector-refresh-sidepane-stale-widget-button-wrapper"));var a=this.Ea("waffle-dataconnector-refresh-sidepane-stale-widget-title");a.id=Nv(this,"waffle-dataconnector-refresh-sidepane-stale-widget-title");uw(a,"heading");ww(this.Ka(),"labelledby",a.id);a=this.Ea("waffle-dataconnector-refresh-sidepane-stale-widget-info");a.id=Nv(this,"waffle-dataconnector-refresh-sidepane-stale-widget-info");ww(this.Ka(),
"describedby",a.id)};function Xug(a,b,c){sY.call(this,a,b);var d=this;this.C=c;this.D=new Vm;this.va(this.D);Wm(this.D,this.C.D,function(e){"dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType()?(Uug(d.Je),e=d.Je,e.Qx.Na(!1),e.D.C.Na(!1)):(Yug(d),lug(d.Je.Qx))});this.Ma.listen(OK,"show-db-objects-refresh-sidepane",this.F)}u(Xug,sY);Xug.prototype.Kf=function(){return Pob};Xug.prototype.Ro=function(){return Qob};
function Yug(a){var b=Ctg(a.C),c=a.Je;0==b.length?Ftg(c.D):(jug(c.Qx),u2e(c.D),Etg(a.C,b,function(d){a.isDisposed()||c.isDisposed()||Wug(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new X6b(d[0].hx(),d[0].Dh()),kug(c.Qx),c.D.xC(d))}))}Xug.prototype.F=function(){var a=this;Sug(this.Je);Vug(this.Je);Tug(this.Je);Yug(this);tY(this);KBa(function(){return a.Je.Ka().focus()})};function Zug(){GK.apply(this,arguments)}u(Zug,GK);Zug.prototype.C=function(){return Xug};Zug.prototype.D=function(){return Pug};MK("dbrefresh",Zug);
